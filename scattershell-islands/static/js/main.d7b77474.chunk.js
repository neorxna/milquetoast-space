(this["webpackJsonpscattershell-islands"]=this["webpackJsonpscattershell-islands"]||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var a,c=n(1),r=n.n(c),o=n(7),i=n.n(o),l=(n(13),n(3)),u=(n(14),n(0)),s="?",f="\ud83c\udf31",b="\ud83d\udee0\ufe0f",d="\ud83d\udccc",h="\ud83c\udf32",v="\ud83d\udca7",p="\ud83c\udf35",O="\u26f0\ufe0f",j=(a={},Object(u.a)(a,s,"undecided"),Object(u.a)(a,f,"food"),Object(u.a)(a,b,"materials"),Object(u.a)(a,d,"settlement"),Object(u.a)(a,h,"grass"),Object(u.a)(a,v,"lagoon"),Object(u.a)(a,p,"desert"),Object(u.a)(a,O,"mountain"),a),g={Tiny:2,Small:3,Medium:5,Large:8};function m(e){var t=e.onActivate,n=e.onDeactivate,a=e.activated,c=e.cellType,o=e.harbour,i=e.canActivate,l=e.canDeactivate,u=e.noneActivated,s=e.allActivated,f=e.dragging,b=e.setDragging,h=c,p=!a&&!i||a&&!l,O=p?{onMouseUp:function(e){b(!1),e.preventDefault()}}:{onMouseDown:function(e){b(!0),a?n():t(),e.preventDefault()},onMouseOver:function(e){f&&(a?n():t())},onMouseUp:function(e){b(!1),e.preventDefault()}},g=!i,m=c===d,y=c!==d&&c!==v&&u,w=s&&!o&&!a;return r.a.createElement("td",Object.assign({className:(a?"cell--activated":"cell--unactivated")+(p?" cell--blocked":"")+(g?" cell--unactivatable":"")+(m?" cell--settlement":"")+(y?" cell--dim":"")+(o?" cell--harbour":"")+(w?" cell--ocean":""),title:"".concat(a?"activated":"unactivated"," ").concat(j[c]),"aria-label":"".concat(j[c],", ").concat(a?"activated":"unactivated",".").concat(o?" harbour.":""," can").concat(p?"not":""," ").concat(a?"de":"","activate").concat(s&&!a?" (no tiles left).":p?" (would create two islands).":".")},O),h)}var y,w,F,T,S,E=function(e,t){var n=function(e){return e-t},a=function(e){return e+t},c=function(e){return e%t===0?void 0:e-1},r=function(e){return e%t===t-1?void 0:e+1};return{up:function(t){return e[n(t)]},down:function(t){return e[a(t)]},left:function(n){return n%t===0?void 0:e[n-1]},right:function(n){return n%t===t-1?void 0:e[n+1]},upright:function(t){return e[n(r(t))]},downleft:function(t){return e[a(c(t))]},upleft:function(t){return e[n(c(t))]},downright:function(t){return e[a(r(t))]}}},B=function(e){return e+Math.floor(e/2)},A=n(2),M=n(4),k=n(5),C={Shellfish:"shellfish",Fish:"fish",Pigs:"pigs",Birds:"birds",BushFood:"bush food",Coconuts:"coconuts",RootVegetables:"root vegetables",PreciousShells:"precious shells",FreshWater:"fresh water",Flax:"flax",Bamboo:"bamboo",SturdyWood:"sturdy wood",FruitTrees:"fruit trees",Guano:"guano",Succulents:"succulents"},D=(y={},Object(u.a)(y,C.Shellfish,!1),Object(u.a)(y,C.Fish,!1),Object(u.a)(y,C.Pigs,!1),Object(u.a)(y,C.Birds,!1),Object(u.a)(y,C.BushFood,!1),Object(u.a)(y,C.Coconuts,!1),Object(u.a)(y,C.RootVegetables,!0),Object(u.a)(y,C.PreciousShells,!1),Object(u.a)(y,C.FreshWater,!1),Object(u.a)(y,C.Flax,!1),Object(u.a)(y,C.Bamboo,!1),Object(u.a)(y,C.SturdyWood,!1),Object(u.a)(y,C.FruitTrees,!0),Object(u.a)(y,C.Guano,!1),w={},Object(u.a)(w,C.Shellfish,!1),Object(u.a)(w,C.Fish,!1),Object(u.a)(w,C.Pigs,!1),Object(u.a)(w,C.Birds,!1),Object(u.a)(w,C.BushFood,!1),Object(u.a)(w,C.Coconuts,!0),Object(u.a)(w,C.RootVegetables,!0),Object(u.a)(w,C.PreciousShells,!0),Object(u.a)(w,C.FreshWater,!1),Object(u.a)(w,C.Flax,!1),Object(u.a)(w,C.Bamboo,!1),Object(u.a)(w,C.SturdyWood,!0),Object(u.a)(w,C.FruitTrees,!1),Object(u.a)(w,C.Guano,!1),F={},Object(u.a)(F,C.Shellfish,!1),Object(u.a)(F,C.Fish,!1),Object(u.a)(F,C.Pigs,!0),Object(u.a)(F,C.Birds,!1),Object(u.a)(F,C.BushFood,!1),Object(u.a)(F,C.Coconuts,!0),Object(u.a)(F,C.RootVegetables,!0),Object(u.a)(F,C.PreciousShells,!1),Object(u.a)(F,C.FreshWater,!1),Object(u.a)(F,C.Flax,!1),Object(u.a)(F,C.Bamboo,!1),Object(u.a)(F,C.SturdyWood,!1),Object(u.a)(F,C.FruitTrees,!0),Object(u.a)(F,C.Guano,!0),T={},Object(u.a)(T,C.Shellfish,2),Object(u.a)(T,C.Fish,3),Object(u.a)(T,C.Pigs,2),Object(u.a)(T,C.Birds,1),Object(u.a)(T,C.BushFood,3),Object(u.a)(T,C.Coconuts,2),Object(u.a)(T,C.RootVegetables,1),Object(u.a)(T,C.PreciousShells,0),Object(u.a)(T,C.FreshWater,2),Object(u.a)(T,C.Flax,0),Object(u.a)(T,C.Bamboo,1),Object(u.a)(T,C.SturdyWood,0),Object(u.a)(T,C.FruitTrees,2),Object(u.a)(T,C.Guano,0),T),W=(S={},Object(u.a)(S,C.Shellfish,1),Object(u.a)(S,C.Fish,0),Object(u.a)(S,C.Pigs,1),Object(u.a)(S,C.Birds,1),Object(u.a)(S,C.BushFood,0),Object(u.a)(S,C.Coconuts,2),Object(u.a)(S,C.RootVegetables,0),Object(u.a)(S,C.PreciousShells,2),Object(u.a)(S,C.FreshWater,0),Object(u.a)(S,C.Flax,3),Object(u.a)(S,C.Bamboo,2),Object(u.a)(S,C.SturdyWood,2),Object(u.a)(S,C.FruitTrees,1),Object(u.a)(S,C.Guano,2),S),P=function(e){return e[Math.floor(Math.random()*e.length)]},x=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},N=Object.values(C).filter((function(e){return W[e]>0})),z=Object.values(C).filter((function(e){return D[e]>0})),G=Object.values(C),R=function(e,t){return{cellType:e,contains:e===b?[P(N),P(N)]:e===f?[P(z),P(z)]:e===p?[P([C.Succulents,C.BushFood,null,null,null])].filter((function(e){return void 0!=e})):e===v?[P([C.FreshWater,null]),P([C.Fish,null])].filter((function(e){return void 0!=e})):[P(G)]}},V=function(e,t,n){var a=E(t,n),c=a.up,r=a.down,o=a.left,i=a.right;return[c(e),r(e),o(e),i(e)].filter((function(e){return e&&e.activated}))},J=function(e,t){var n=[],a={},c=null,r=e.filter((function(e){return e.activated}));if(!r[0])return!0;for(n.push(r[0].pos);n.length>0;)if(c=n.shift(),!a[c]){a[c]=!0;var o=V(c,e,t),i=!0,l=!1,u=void 0;try{for(var s,f=o[Symbol.iterator]();!(i=(s=f.next()).done);i=!0){var b=s.value;n.push(b.pos)}}catch(d){l=!0,u=d}finally{try{i||null==f.return||f.return()}finally{if(l)throw u}}}return 0===e.filter((function(e){return e.activated&&!a[e.pos]})).length};function U(e){var t=Object(c.useState)((function(){return function(e){for(var t={cellType:s,activated:!1},n=function(t,n){return n*e+t},a=Array(e*e).fill(Object(A.a)({},t)).map((function(e,t){return Object(A.a)({},e,{pos:t})})),c=E(a,e),r=c.up,o=c.down,i=c.left,l=c.right,u=c.upleft,j=c.upright,g=c.downleft,m=c.downright,y=0;y<e/4;y++){var w=x(0,e-1),F=x(0,e-1),T=a[n(w,F)];a[n(w,F)]=Object(A.a)({},T,{cellType:d})}var S=P(a.filter((function(e){return e.cellType===d}))).pos,B=[r(S),o(S),i(S),l(S)].filter((function(e){return void 0!=e&&e.cellType===s})),C=P(B);a[C.pos]=Object(A.a)({},C,{},R(f)),console.log("added essential food",C);var D=function(t){for(var n,c=[a[S]],u=function(){var e=c[c.length-1],t=[r,o,i,l].map((function(t){return t(e.pos)})).filter((function(e){return e&&(c.length>3?e.cellType===s:e.cellType!==d&&e.cellType!==f)&&0===c.filter((function(t){return t.pos===e.pos})).length})),n=P(t);if(!n)return console.log("breaking"),"break";c.push(n)};c.length<e;){if("break"===u())break}return n=c.pop(),a[n.pos]=Object(A.a)({},n,{},t([r,o,i,l].map((function(e){return e(n.pos)})))),[].concat(c,[n])},W=D((function(e){return R(b)}));if(console.log("added essential materials",W),e>5){var N=D((function(e){return R(O)}));console.log("added essential mountain",N)}console.log("doing poisson stuff...");return new k([e,e],e/1.5).fill().map((function(e){return n(Math.round(e[0]),Math.round(e[1]))})).forEach((function(e){if(a[e]&&a[e].cellType===s){var t=[r,o,i,l].concat(Object(M.a)(P([[j,g],[m,u]]))).map((function(t){return t(e)})),n=0,c=!0,f=!1,b=void 0;try{for(var d,h=t[Symbol.iterator]();!(c=(d=h.next()).done);c=!0){var O=d.value;O&&O.cellType===s&&(a[O.pos]=Object(A.a)({},a[O.pos],{},R(p)),n+=1)}}catch(y){f=!0,b=y}finally{try{c||null==h.return||h.return()}finally{if(f)throw b}}a[e]=Object(A.a)({},a[e],{},R(6===n?v:p))}})),new k([e,e],e/4).fill().map((function(e){return n(Math.round(e[0]),Math.round(e[1]))})).forEach((function(e){var t=0===[i,l,r,o].map((function(t){return t(e)})).filter((function(e){return void 0==e||e.cellType===O})).length;if(a[e]&&a[e].cellType===s&&t){a[e]=Object(A.a)({},a[e],{},R(O));for(var n=[j(e),g(e)],c=function(){var e=f[u];e&&e.cellType===s&&(0===[r,o,i,l].map((function(t){return t(e.pos)})).filter((function(e){return void 0==e||e.cellType===O})).length&&(a[e.pos]=Object(A.a)({},a[e.pos],{},R(O))))},u=0,f=n;u<f.length;u++)c()}})),new k([e,e],e/8).fill().map((function(e){return n(Math.round(e[0]),Math.round(e[1]))})).forEach((function(e){a[e]&&a[e].cellType===s&&(a[e]=Object(A.a)({},a[e],{},R(h)))})),console.log("filling remaining cells"),a.forEach((function(e){e.cellType===s&&(a[e.pos]=Object(A.a)({},e,{},R(P([f,b,v]))))})),console.log("generated grid",a),a}(e)})),n=Object(l.a)(t,2),a=n[0],r=n[1],o=a.reduce((function(t,n){var a=t[t.length-1];return a.length===e?[].concat(Object(M.a)(t),[[n]]):[].concat(Object(M.a)(t.slice(0,t.length-1)),[[].concat(Object(M.a)(a),[n])])}),[[]]),i=B(e),u=i-function(e){return e.reduce((function(e,t){return e+(t.activated?1:0)}),0)}(a),j=u===i,g=function(t,n){return n*e+t},m=function(t,n,a,c,r){var o=g(t,n),i=c[o];if(void 0!==i){var l=Object(M.a)(c);return l[o]=Object(A.a)({},i,{},a),J(l,e)?!!r||l:!r&&c}return!r&&c},y=function(t,n){var c=g(t,n);return V(c,a,e).length>0},w=[],F=E(a,e),T=F.up,S=F.down,C=F.left,D=F.right,W=a.filter((function(e){return e.activated&&e.cellType===d})).length>0,N=a.filter((function(e){return!(!e.activated||e.cellType!==v)&&(4===[T(e.pos),S(e.pos),C(e.pos),D(e.pos)].filter((function(e){return e&&e.activated})).length||void 0)})).length>0;if(W||N?(W&&w.push("\u2714 settlement"),N&&w.push("\u2714 lagoon with four neighbours")):w.push("need settlement (".concat(d,")").concat(e>2?" or lagoon (\ud83d\udca7) with four neighbours":"")),e>2){var z=a.filter((function(e){return e.activated&&e.cellType===d}));z.filter((function(e){return[T(e.pos),S(e.pos),C(e.pos),D(e.pos)].filter((function(e){return e&&e.activated})).length>1})).length===z.length&&z.length>0?w.push("\u2714 settlements have at least two neighbours"):z.length>0&&w.push("settlements need at least two neighbours")}8===e&&(a.filter((function(e){return e.activated&&e.cellType===O})).length>0?w.push("\ufe0f\u2714 at least one mountain"):w.push("need mountain (".concat(O,")")));var G=[];Object(c.useEffect)((function(){r((function(t){return t.map((function(n){var a=E(t,e),c=a.up,r=a.down,o=a.left,i=a.right,l=[["u",c(n.pos)],["d",r(n.pos)],["l",o(n.pos)],["r",i(n.pos)]].filter((function(e){return e[1]&&e[1].activated}));return!n.activated&&l.length>1?Object(A.a)({},n,{harbour:l.reduce((function(e,t){return e+t[0]}),"")}):Object(A.a)({},n,{harbour:!1})}))}))}),[a.filter((function(e){return e.activated})).length]);var U=a.filter((function(e){return e.harbour})).length;U>0&&G.push("".concat(U," fishing harbour").concat(U>1?"s":""));var H={};a.forEach((function(e){e.activated&&e.contains&&e.contains.length>0&&e.contains.forEach((function(e){return H[e]=H[e]?H[e]+1:1}))})),Object.entries(H).length>0&&U>0&&G.push("*");for(var I=0,L=Object.entries(H);I<L.length;I++){var $=L[I],q=Object(l.a)($,2),K=q[0],Q=q[1];G.push("".concat(K," ").concat(Q>1?"x".concat(Q):""))}return{grid:a,gridByRow:o,checkConnected:J,remainingActives:u,noneActivated:j,updateCell:function(e,t,n){r((function(a){return m(e,t,n,a,!1)}))},cellHasActivatedNeighbour:y,cellCanActivate:function(e,t){return u>0&&(j||y(e,t))},cellCanDeactivate:function(e,t){return m(e,t,{activated:!1},a,!0)},clearGrid:function(){r((function(e){return e.map((function(e){return Object(A.a)({},e,{activated:!1})}))}))},messages:w,notes:G}}function H(e){var t=e.islandSize,n=e.currentSize,a=e.updateSize,o=U(t),i=o.gridByRow,u=o.remainingActives,s=o.noneActivated,f=o.updateCell,b=o.cellCanDeactivate,d=o.cellCanActivate,h=o.clearGrid,v=o.messages,p=o.notes,O=Object(c.useState)(!1),j=Object(l.a)(O,2),y=j[0],w=j[1];return r.a.createElement("div",{className:"grid-container"},r.a.createElement("div",{className:"size-picker"},Object.values(g).map((function(e){var t=B(e),c="".concat(u," remaining tiles");return e===n?r.a.createElement("h2",{title:c,"aria-label":c},u):r.a.createElement("span",{className:"size-choice"},r.a.createElement("a",{href:"#",onClick:function(){return a(e)},"aria-label":"change to ".concat(t," size")},t))}))),r.a.createElement("div",{className:"table-container"},r.a.createElement("table",{"aria-label":"game tiles"},i.map((function(e,t){return r.a.createElement("tr",null,e.map((function(e,n){return r.a.createElement(m,{cellType:e.cellType,activated:e.activated,harbour:e.harbour,canActivate:d(n,t),canDeactivate:b(n,t),onActivate:function(){return f(n,t,{activated:!0})},onDeactivate:function(){return f(n,t,{activated:!1})},noneActivated:s,allActivated:0===u,dragging:y,setDragging:w})})))})))),r.a.createElement("div",{className:"restart"},r.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),h()},"aria-label":"restart game (deactivates all tiles)"},"restart")),r.a.createElement("div",{className:"info"},r.a.createElement("ul",{className:"messages"},v.map((function(e,t){return r.a.createElement("li",{key:"".concat(t).concat((new Date).getTime())},e)}))),r.a.createElement("ul",{className:"notes"},p.map((function(e,t){return r.a.createElement("li",{key:"".concat(t).concat((new Date).getTime())},e)})))))}var I=function(){var e=Object(c.useState)(g.Tiny),t=Object(l.a)(e,2),n=t[0],a=t[1];return r.a.createElement("div",{className:"App"},Object.values(g).map((function(e){return e===n?r.a.createElement(H,{islandSize:e,currentSize:n,updateSize:a}):""})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},8:function(e,t,n){e.exports=n(18)}},[[8,1,2]]]);
//# sourceMappingURL=main.d7b77474.chunk.js.map