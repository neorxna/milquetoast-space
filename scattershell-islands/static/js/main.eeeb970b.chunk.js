(this["webpackJsonpscattershell-islands"]=this["webpackJsonpscattershell-islands"]||[]).push([[0],{13:function(e,t,n){},14:function(e,t,n){},18:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),c=n(7),o=n.n(c),i=(n(13),n(14),n(4)),l="?",u="\ud83c\udf31",s="\ud83d\udee0\ufe0f",f="\ud83d\udccc",h="\ud83c\udf32",b="\ud83d\udca7",d="\ud83c\udf35",v="\u26f0\ufe0f",p=2,g=3,O=5,j=8;function m(e){var t=e.onActivate,n=e.onDeactivate,a=e.activated,c=e.cellType,o=e.harbour,i=e.canActivate,l=e.canDeactivate,u=e.noneActivated,s=e.allActivated,h=e.dragging,d=e.setDragging,v=c,p=!a&&!i||a&&!l,g=p?{onMouseUp:function(e){d(!1),e.preventDefault()}}:{onMouseDown:function(e){d(!0),a?n():t(),e.preventDefault()},onMouseOver:function(e){h&&(a?n():t())},onMouseUp:function(e){d(!1),e.preventDefault()}};return r.a.createElement("td",Object.assign({className:(a?"cell--activated":"cell--unactivated")+(p?" cell--blocked":"")+(i?"":" cell--unactivatable")+(c===f?" cell--settlement":"")+(c!==f&&c!==b&&u?" cell--dim":"")+(o?" cell--harbour":"")+(!s||o||a?"":" cell--ocean")},g),o&&r.a.createElement("div",{className:"harbour harbour-".concat(o)}),v)}var y,w,F,T,E,S=n(2),B=n(3),A=function(e,t){var n=function(e){return e-t},a=function(e){return e+t},r=function(e){return e%t===0?void 0:e-1},c=function(e){return e%t===t-1?void 0:e+1};return{up:function(t){return e[n(t)]},down:function(t){return e[a(t)]},left:function(n){return n%t===0?void 0:e[n-1]},right:function(n){return n%t===t-1?void 0:e[n+1]},upright:function(t){return e[n(c(t))]},downleft:function(t){return e[a(r(t))]},upleft:function(t){return e[n(r(t))]},downright:function(t){return e[a(c(t))]}}},D=n(5),M=n(0),W={Shellfish:"shellfish",Fish:"fish",Pigs:"pigs",Birds:"birds",BushFood:"bush food",Coconuts:"coconuts",RootVegetables:"root vegetables",PreciousShells:"precious shells",FreshWater:"fresh water",Flax:"flax",Bamboo:"bamboo",SturdyWood:"sturdy wood",FruitTrees:"fruit trees",Guano:"guano",Succulents:"succulents"},C=(y={},Object(M.a)(y,W.Shellfish,!1),Object(M.a)(y,W.Fish,!1),Object(M.a)(y,W.Pigs,!1),Object(M.a)(y,W.Birds,!1),Object(M.a)(y,W.BushFood,!1),Object(M.a)(y,W.Coconuts,!1),Object(M.a)(y,W.RootVegetables,!0),Object(M.a)(y,W.PreciousShells,!1),Object(M.a)(y,W.FreshWater,!1),Object(M.a)(y,W.Flax,!1),Object(M.a)(y,W.Bamboo,!1),Object(M.a)(y,W.SturdyWood,!1),Object(M.a)(y,W.FruitTrees,!0),Object(M.a)(y,W.Guano,!1),w={},Object(M.a)(w,W.Shellfish,!1),Object(M.a)(w,W.Fish,!1),Object(M.a)(w,W.Pigs,!1),Object(M.a)(w,W.Birds,!1),Object(M.a)(w,W.BushFood,!1),Object(M.a)(w,W.Coconuts,!0),Object(M.a)(w,W.RootVegetables,!0),Object(M.a)(w,W.PreciousShells,!0),Object(M.a)(w,W.FreshWater,!1),Object(M.a)(w,W.Flax,!1),Object(M.a)(w,W.Bamboo,!1),Object(M.a)(w,W.SturdyWood,!0),Object(M.a)(w,W.FruitTrees,!1),Object(M.a)(w,W.Guano,!1),F={},Object(M.a)(F,W.Shellfish,!1),Object(M.a)(F,W.Fish,!1),Object(M.a)(F,W.Pigs,!0),Object(M.a)(F,W.Birds,!1),Object(M.a)(F,W.BushFood,!1),Object(M.a)(F,W.Coconuts,!0),Object(M.a)(F,W.RootVegetables,!0),Object(M.a)(F,W.PreciousShells,!1),Object(M.a)(F,W.FreshWater,!1),Object(M.a)(F,W.Flax,!1),Object(M.a)(F,W.Bamboo,!1),Object(M.a)(F,W.SturdyWood,!1),Object(M.a)(F,W.FruitTrees,!0),Object(M.a)(F,W.Guano,!0),T={},Object(M.a)(T,W.Shellfish,2),Object(M.a)(T,W.Fish,3),Object(M.a)(T,W.Pigs,2),Object(M.a)(T,W.Birds,1),Object(M.a)(T,W.BushFood,3),Object(M.a)(T,W.Coconuts,2),Object(M.a)(T,W.RootVegetables,1),Object(M.a)(T,W.PreciousShells,0),Object(M.a)(T,W.FreshWater,2),Object(M.a)(T,W.Flax,0),Object(M.a)(T,W.Bamboo,1),Object(M.a)(T,W.SturdyWood,0),Object(M.a)(T,W.FruitTrees,2),Object(M.a)(T,W.Guano,0),T),k=(E={},Object(M.a)(E,W.Shellfish,1),Object(M.a)(E,W.Fish,0),Object(M.a)(E,W.Pigs,1),Object(M.a)(E,W.Birds,1),Object(M.a)(E,W.BushFood,0),Object(M.a)(E,W.Coconuts,2),Object(M.a)(E,W.RootVegetables,0),Object(M.a)(E,W.PreciousShells,2),Object(M.a)(E,W.FreshWater,0),Object(M.a)(E,W.Flax,3),Object(M.a)(E,W.Bamboo,2),Object(M.a)(E,W.SturdyWood,2),Object(M.a)(E,W.FruitTrees,1),Object(M.a)(E,W.Guano,2),E),P=function(e){return e[Math.floor(Math.random()*e.length)]},x=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},N=Object.values(W).filter((function(e){return k[e]>0})),G=Object.values(W).filter((function(e){return C[e]>0})),R=Object.values(W),V=function(e,t){return{cellType:e,contains:e===s?[P(N),P(N)]:e===u?[P(G),P(G)]:e===d?[P([W.Succulents,W.BushFood,null,null,null])].filter((function(e){return void 0!=e})):e===b?[P([W.FreshWater,null]),P([W.Fish,null])].filter((function(e){return void 0!=e})):[P(R)]}},z=function(e,t,n){var a=A(t,n),r=a.up,c=a.down,o=a.left,i=a.right;return[r(e),c(e),o(e),i(e)].filter((function(e){return e&&e.activated}))},J=function(e,t){var n=[],a={},r=null,c=e.filter((function(e){return e.activated}));if(!c[0])return!0;for(n.push(c[0].pos);n.length>0;)if(r=n.shift(),!a[r]){a[r]=!0;var o=z(r,e,t),i=!0,l=!1,u=void 0;try{for(var s,f=o[Symbol.iterator]();!(i=(s=f.next()).done);i=!0){var h=s.value;n.push(h.pos)}}catch(b){l=!0,u=b}finally{try{i||null==f.return||f.return()}finally{if(l)throw u}}}return 0===e.filter((function(e){return e.activated&&!a[e.pos]})).length};function U(e){var t=Object(a.useState)((function(){return function(e){for(var t={cellType:l,activated:!1},n=function(t,n){return n*e+t},a=Array(e*e).fill(Object(S.a)({},t)).map((function(e,t){return Object(S.a)({},e,{pos:t})})),r=A(a,e),c=r.up,o=r.down,i=r.left,p=r.right,g=r.upleft,O=r.upright,j=r.downleft,m=r.downright,y=0;y<e/4;y++){var w=x(0,e-1),F=x(0,e-1),T=a[n(w,F)];a[n(w,F)]=Object(S.a)({},T,{cellType:f})}var E=P(a.filter((function(e){return e.cellType===f}))).pos,M=[c(E),o(E),i(E),p(E)].filter((function(e){return void 0!=e&&e.cellType===l})),W=P(M);a[W.pos]=Object(S.a)({},W,{},V(u)),console.log("added essential food",W);var C=function(t){for(var n,r=[a[E]],s=function(){var e=r[r.length-1],t=[c,o,i,p].map((function(t){return t(e.pos)})).filter((function(e){return e&&(r.length>3?e.cellType===l:e.cellType!==f&&e.cellType!==u)&&0===r.filter((function(t){return t.pos===e.pos})).length})),n=P(t);if(!n)return console.log("breaking"),"break";r.push(n)};r.length<e;){if("break"===s())break}return n=r.pop(),a[n.pos]=Object(S.a)({},n,{},t([c,o,i,p].map((function(e){return e(n.pos)})))),[].concat(r,[n])},k=C((function(e){return V(s)}));if(console.log("added essential materials",k),e>5){var N=C((function(e){return V(v)}));console.log("added essential mountain",N)}console.log("doing poisson stuff...");return new D([e,e],e/1.5).fill().map((function(e){return n(Math.round(e[0]),Math.round(e[1]))})).forEach((function(e){if(a[e]&&a[e].cellType===l){var t=[c,o,i,p].concat(Object(B.a)(P([[O,j],[m,g]]))).map((function(t){return t(e)})),n=0,r=!0,u=!1,s=void 0;try{for(var f,h=t[Symbol.iterator]();!(r=(f=h.next()).done);r=!0){var v=f.value;v&&v.cellType===l&&(a[v.pos]=Object(S.a)({},a[v.pos],{},V(d)),n+=1)}}catch(y){u=!0,s=y}finally{try{r||null==h.return||h.return()}finally{if(u)throw s}}a[e]=Object(S.a)({},a[e],{},V(6===n?b:d))}})),new D([e,e],e/4).fill().map((function(e){return n(Math.round(e[0]),Math.round(e[1]))})).forEach((function(e){var t=0===[i,p,c,o].map((function(t){return t(e)})).filter((function(e){return void 0==e||e.cellType===v})).length;if(a[e]&&a[e].cellType===l&&t){a[e]=Object(S.a)({},a[e],{},V(v));for(var n=[O(e),j(e)],r=function(){var e=s[u];e&&e.cellType===l&&(0===[c,o,i,p].map((function(t){return t(e.pos)})).filter((function(e){return void 0==e||e.cellType===v})).length&&(a[e.pos]=Object(S.a)({},a[e.pos],{},V(v))))},u=0,s=n;u<s.length;u++)r()}})),new D([e,e],e/8).fill().map((function(e){return n(Math.round(e[0]),Math.round(e[1]))})).forEach((function(e){a[e]&&a[e].cellType===l&&(a[e]=Object(S.a)({},a[e],{},V(h)))})),console.log("filling remaining cells"),a.forEach((function(e){e.cellType===l&&(a[e.pos]=Object(S.a)({},e,{},V(P([u,s,b]))))})),console.log("generated grid",a),a}(e)})),n=Object(i.a)(t,2),c=n[0],o=n[1],p=c.reduce((function(t,n){var a=t[t.length-1];return a.length===e?[].concat(Object(B.a)(t),[[n]]):[].concat(Object(B.a)(t.slice(0,t.length-1)),[[].concat(Object(B.a)(a),[n])])}),[[]]),g=e+Math.floor(e/2),O=g-function(e){return e.reduce((function(e,t){return e+(t.activated?1:0)}),0)}(c),j=O===g,m=function(t,n){return n*e+t},y=function(t,n,a,r,c){var o=m(t,n),i=r[o];if(void 0!==i){var l=Object(B.a)(r);return l[o]=Object(S.a)({},i,{},a),J(l,e)?!!c||l:!c&&r}return!c&&r},w=function(t,n){var a=m(t,n);return z(a,c,e).length>0},F=[],T=A(c,e),E=T.up,M=T.down,W=T.left,C=T.right,k=c.filter((function(e){return e.activated&&e.cellType===f})).length>0,N=c.filter((function(e){return!(!e.activated||e.cellType!==b)&&(4===[E(e.pos),M(e.pos),W(e.pos),C(e.pos)].filter((function(e){return e&&e.activated})).length||void 0)})).length>0;if(k||N?(k&&F.push("\u2714 settlement"),N&&F.push("\u2714 lagoon with four neighbours")):F.push("need settlement (".concat(f,")").concat(e>2?" or lagoon (\ud83d\udca7) with four neighbours":"")),e>2){var G=c.filter((function(e){return e.activated&&e.cellType===f}));G.filter((function(e){return[E(e.pos),M(e.pos),W(e.pos),C(e.pos)].filter((function(e){return e&&e.activated})).length>1})).length===G.length&&G.length>0?F.push("\u2714 settlements have at least two neighbours"):G.length>0&&F.push("settlements need at least two neighbours")}8===e&&(c.filter((function(e){return e.activated&&e.cellType===v})).length>0?F.push("\ufe0f\u2714 at least one mountain"):F.push("need mountain (".concat(v,")")));var R=[];Object(a.useEffect)((function(){o((function(t){return t.map((function(n){var a=A(t,e),r=a.up,c=a.down,o=a.left,i=a.right,l=[["u",r(n.pos)],["d",c(n.pos)],["l",o(n.pos)],["r",i(n.pos)]].filter((function(e){return e[1]&&e[1].activated}));return!n.activated&&l.length>1?Object(S.a)({},n,{harbour:l.reduce((function(e,t){return e+t[0]}),"")}):Object(S.a)({},n,{harbour:!1})}))}))}),[c.filter((function(e){return e.activated})).length]);var U=c.filter((function(e){return e.harbour})).length;U>0&&R.push("".concat(U," fishing harbour").concat(U>1?"s":""));var H={};c.forEach((function(e){e.activated&&e.contains&&e.contains.length>0&&e.contains.forEach((function(e){return H[e]=H[e]?H[e]+1:1}))})),Object.entries(H).length>0&&U>0&&R.push(r.a.createElement("br",null));for(var I=0,$=Object.entries(H);I<$.length;I++){var q=$[I],K=Object(i.a)(q,2),L=K[0],Q=K[1];R.push("".concat(L," ").concat(Q>1?"x".concat(Q):""))}return{grid:c,gridByRow:p,checkConnected:J,remainingActives:O,noneActivated:j,updateCell:function(e,t,n){o((function(a){return y(e,t,n,a,!1)}))},cellHasActivatedNeighbour:w,cellCanActivate:function(e,t){return O>0&&(j||w(e,t))},cellCanDeactivate:function(e,t){return y(e,t,{activated:!1},c,!0)},clearGrid:function(){o((function(e){return e.map((function(e){return Object(S.a)({},e,{activated:!1})}))}))},messages:F,notes:R}}function H(e){var t=U(e.islandSize),n=t.gridByRow,c=t.remainingActives,o=t.noneActivated,l=t.updateCell,u=t.cellCanDeactivate,s=t.cellCanActivate,f=t.clearGrid,h=t.messages,b=t.notes,d=Object(a.useState)(!1),v=Object(i.a)(d,2),p=v[0],g=v[1];return r.a.createElement("div",{className:"game-container"},r.a.createElement("div",{className:"grid-container"},r.a.createElement("h2",null,c),r.a.createElement("div",{className:"table-container"},r.a.createElement("table",null,n.map((function(e,t){return r.a.createElement("tr",null,e.map((function(e,n){return r.a.createElement(m,{cellType:e.cellType,activated:e.activated,harbour:e.harbour,canActivate:s(n,t),canDeactivate:u(n,t),onActivate:function(){return l(n,t,{activated:!0})},onDeactivate:function(){return l(n,t,{activated:!1})},noneActivated:o,allActivated:0===c,dragging:p,setDragging:g})})))})))),r.a.createElement("div",{className:"info"},r.a.createElement("ul",{className:"messages"},h.map((function(e,t){return r.a.createElement("li",{key:"".concat(t).concat((new Date).getTime())},e)}))),r.a.createElement("ul",{className:"notes"},b.map((function(e,t){return r.a.createElement("li",{key:"".concat(t).concat((new Date).getTime())},e)}))))),r.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),f()}},"restart"))}var I=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(H,{islandSize:p}),r.a.createElement(H,{islandSize:g}),r.a.createElement(H,{islandSize:O}),r.a.createElement(H,{islandSize:j}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(I,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},8:function(e,t,n){e.exports=n(18)}},[[8,1,2]]]);
//# sourceMappingURL=main.eeeb970b.chunk.js.map