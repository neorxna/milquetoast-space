(this["webpackJsonpscattershell-islands"]=this["webpackJsonpscattershell-islands"]||[]).push([[0],{12:function(e,t,n){},13:function(e,t,n){},17:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(4),l=n.n(c),i=(n(12),n(13),"?"),o="\ud83c\udf31",u="\ud83d\udee0\ufe0f",f="\ud83d\udccc",s="\ud83c\udf32",h="\ud83d\udca7",v="\ud83c\udf35",d="\u26f0\ufe0f",p=2,m=3,g=5,b=8;function y(e){var t=e.onActivate,n=e.onDeactivate,a=e.activated,c=e.cellType,l=e.harbour,i=e.canActivate,o=e.canDeactivate,u=e.noneActivated,s=c,h=!a&&!i||a&&!o,v=h?{}:{onClick:function(e){e.preventDefault(),a?n():t()}};return r.a.createElement("td",Object.assign({className:(a?"cell--activated":"cell--unactivated")+(h?" cell--blocked":"")+(i?"":" cell--unactivatable")+(c===f?" cell--settlement":"")+(c!==f&&u?" cell--dim":"")+(l?" cell--harbour":"")},v),l&&r.a.createElement("div",{className:"harbour harbour-".concat(l)}),s)}var E=n(1),T=n(2),w=n(6),j=function(e,t){return{up:function(n){return e[n-t]},down:function(n){return e[n+t]},left:function(n){return n%t===0?void 0:e[n-1]},right:function(n){return n%t===t-1?void 0:e[n+1]}}},O=n(5),A=function(e){return e[Math.floor(Math.random()*e.length)]},k=function(e,t){return Math.floor(Math.random()*(t-e+1)+e)},D=function(e,t,n){var a=j(t,n),r=a.up,c=a.down,l=a.left,i=a.right;return[r(e),c(e),l(e),i(e)].filter((function(e){return e&&e.activated}))},N=function(e,t){var n=[],a={},r=null,c=e.filter((function(e){return e.activated}));if(!c[0])return!0;for(n.push(c[0].pos);n.length>0;)if(r=n.shift(),!a[r]){a[r]=!0;var l=D(r,e,t),i=!0,o=!1,u=void 0;try{for(var f,s=l[Symbol.iterator]();!(i=(f=s.next()).done);i=!0){var h=f.value;n.push(h.pos)}}catch(v){o=!0,u=v}finally{try{i||null==s.return||s.return()}finally{if(o)throw u}}}return 0===e.filter((function(e){return e.activated&&!a[e.pos]})).length};function C(e){var t=Object(a.useState)((function(){return function(e){for(var t={cellType:i,activated:!1},n=function(t,n){return n*e+t},a=Array(e*e).fill(Object(E.a)({},t)).map((function(e,t){return Object(E.a)({},e,{pos:t})})),r=j(a,e),c=r.up,l=r.down,p=r.left,m=r.right,g=0;g<e/4;g++){var b=k(0,e-1),y=k(0,e-1),T=a[n(b,y)];a[n(b,y)]=Object(E.a)({},T,{cellType:f})}var w=A(a.filter((function(e){return e.cellType===f}))).pos,D=[c(w),l(w),p(w),m(w)].filter((function(e){return void 0!=e&&e.cellType===i})),N=A(D);if(a[N.pos]=Object(E.a)({},N,{cellType:o}),e>=3){for(var C=[a[w]];C.length<e;){var S=C[C.length-1].pos,x=[c(S),l(S),p(S),m(S)].filter((function(e){return void 0!=e&&e.cellType===i})),M=A(x);void 0!=M&&C.push(M)}var z=C[C.length-1];a[z.pos]=Object(E.a)({},z,{cellType:u})}return e>5&&function(){for(var e=[a[w]];e.length<6;){var t=e[e.length-1].pos,n=[c(t),l(t),p(t),m(t)].filter((function(t){return void 0!=t&&t.cellType===i&&0===e.filter((function(e){return e.pos===t.pos})).length})),r=A(n);if(void 0==r)break;e.push(r)}var o=e[e.length-1];a[o.pos]=Object(E.a)({},o,{cellType:d})}(),console.log("starting poisson..."),new O([e,e],e/10).fill().map((function(e){return n(Math.round(e[0]),Math.round(e[1]))})).forEach((function(e){a[e]&&a[e].cellType===i&&(a[e].cellType=A([s,d,h,v]))})),a.forEach((function(e){e.cellType===i&&(e.cellType=A([o,u,i]))})),console.log("generated grid",a),a}(e)})),n=Object(w.a)(t,2),r=n[0],c=n[1],l=r.reduce((function(t,n){var a=t[t.length-1];return a.length===e?[].concat(Object(T.a)(t),[[n]]):[].concat(Object(T.a)(t.slice(0,t.length-1)),[[].concat(Object(T.a)(a),[n])])}),[[]]),p=e-function(e){return e.reduce((function(e,t){return e+(t.activated?1:0)}),0)}(r),m=function(t,n){return n*e+t},g=function(t,n,a,r,c){var l=m(t,n),i=r[l];if(void 0!==i){var o=Object(T.a)(r);return o[l]=Object(E.a)({},i,{},a),N(o,e)?!!c||o:!c&&r}return!c&&r},b=[],y=j(r,e),C=y.up,S=y.down,x=y.left,M=y.right;if(r.filter((function(e){return e.activated&&e.cellType===f})).length>0?b.push("\u2714 at least one settlement"):b.push("need settlement (".concat(f,")")),e>2){var z=r.filter((function(e){return e.activated&&e.cellType===f}));z.filter((function(e){return[C(e.pos),S(e.pos),x(e.pos),M(e.pos)].filter((function(e){return e&&e.activated})).length>1})).length===z.length&&z.length>0?b.push("\u2714\ufe0f settlements have at least two neighbours"):z.length>0&&b.push("settlements need at least two neighbours")}8===e&&(r.filter((function(e){return e.activated&&e.cellType===d})).length>0?b.push("\u2714\ufe0f at least one mountain"):b.push("need mountain (".concat(d,")")));var B=[];Object(a.useEffect)((function(){c((function(t){return t.map((function(n){var a=j(t,e),r=a.up,c=a.down,l=a.left,i=a.right,o=[["u",r(n.pos)],["d",c(n.pos)],["l",l(n.pos)],["r",i(n.pos)]].filter((function(e){return e[1]&&e[1].activated}));return!n.activated&&o.length>1?Object(E.a)({},n,{harbour:o.reduce((function(e,t){return e+t[0]}),"")}):Object(E.a)({},n,{harbour:!1})}))}))}),[r.filter((function(e){return e.activated})).length]);var G=r.filter((function(e){return e.harbour})).length;G>0&&B.push("".concat(G," harbour").concat(G>1?"s":""," (fishing possible)"));var H=r.filter((function(e){return e.activated&&e.cellType===o})).length;0===H&&0===G?B.push("food may be hard to come by."):H>0&&B.push("bountiful food x".concat(H));var J=r.filter((function(e){return e.activated&&e.cellType===u})).length;0===J?B.push("materials may be hard to come by."):B.push("bountiful materials x".concat(J));var R=r.filter((function(e){return e.activated&&e.cellType===s})).length;R>0&&B.push("grasslands x".concat(R));var W=r.filter((function(e){return e.activated&&e.cellType===h})).length;return W>0&&B.push("lagoon x".concat(W)),{grid:r,gridByRow:l,checkConnected:N,remainingActives:p,updateCell:function(e,t,n){c((function(a){return g(e,t,n,a,!1)}))},cellHasActivatedNeighbour:function(t,n){var a=m(t,n);return D(a,r,e).length>0},cellCanDeactivate:function(e,t){return g(e,t,{activated:!1},r,!0)},clearGrid:function(){c((function(e){return e.map((function(e){return Object(E.a)({},e,{activated:!1})}))}))},messages:b,notes:B}}function S(e){var t=e.islandSize,n=C(t),a=n.gridByRow,c=n.remainingActives,l=n.updateCell,i=n.cellHasActivatedNeighbour,o=n.cellCanDeactivate,u=n.clearGrid,f=n.messages,s=n.notes;return r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,c),r.a.createElement("table",null,a.map((function(e,n){return r.a.createElement("tr",null,e.map((function(e,a){return r.a.createElement(y,{cellType:e.cellType,activated:e.activated,harbour:e.harbour,canActivate:c>0&&(c===t||i(a,n)),canDeactivate:o(a,n),onActivate:function(){return l(a,n,{activated:!0})},onDeactivate:function(){return l(a,n,{activated:!1})},noneActivated:c===t})})))}))),r.a.createElement("div",{className:"info"},r.a.createElement("a",{href:"#",onClick:function(e){e.preventDefault(),u()}},"clear"),r.a.createElement("ul",{className:"messages"},f.map((function(e,t){return r.a.createElement("li",{key:"".concat(e).concat(t)},e)}))),s.length>0&&"-",r.a.createElement("ul",{className:"notes"},s.map((function(e,t){return r.a.createElement("li",{key:"".concat(e).concat(t)},e)})))))}var x=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(S,{islandSize:p}),r.a.createElement("hr",null),r.a.createElement(S,{islandSize:m}),r.a.createElement("hr",null),r.a.createElement(S,{islandSize:g}),r.a.createElement("hr",null),r.a.createElement(S,{islandSize:b}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(r.a.createElement(x,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},7:function(e,t,n){e.exports=n(17)}},[[7,1,2]]]);
//# sourceMappingURL=main.d05fc681.chunk.js.map